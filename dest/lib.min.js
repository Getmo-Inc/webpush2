!function(e){"use strict";var t,r,o,a,n,i="2.1.0",s=-1===(e.location.href+"").indexOf("local.getmo.")?"https://api.getmo.com.br":"https://local.getmo.api",p="https://cdn.getmo.com.br/polyfills/fetch.js";t=function(){},t.prototype.element=e.document.createElement("div"),t.prototype.listeners=[],t.prototype._getIndex=function(e){var t;for(t=0;t<this.listeners.length;t++)if(this.listeners[t].name===e)return t;return!1},t.prototype.on=function(e,t){this.listeners.push({name:e,callback:t,type:"on"}),this.element.addEventListener(e,t)},t.prototype.one=function(e,t){this.listeners.push({name:e,callback:t,type:"one"}),this.element.addEventListener(e,t)},t.prototype.off=function(e){var t=this._getIndex(e);t!==!1&&(this.element.removeEventListener(e,this.listeners[t].callback),this.listeners.splice(t,1))},t.prototype.trigger=function(t,r){this.element.dispatchEvent(new e.CustomEvent(t,{detail:r}));var o=this._getIndex(t);o!==!1&&"one"===this.listeners[o].type&&this.off(t)},t.prototype.once=function(t,r){this.element.dispatchEvent(new e.CustomEvent(t,{detail:r})),this.off(t)},r=function(){this._platform=null,this._browserVersion=null},r.prototype._checkFeature=function(t){switch(t){case"postMessage":return"postMessage"in e;case"Notification":return"Notification"in e;case"localStorage":try{return"localStorage"in e&&null!==e.localStorage}catch(r){return!1}break;case"permission":return"permission"in e.Notification;case"showNotification":try{return"showNotification"in e.ServiceWorkerRegistration.prototype}catch(r){return}break;case"serviceWorker":return"serviceWorker"in e.navigator;case"PushManager":return"PushManager"in e;case"pushNotification":return"pushNotification"in e.safari}return!0},r.prototype._getPlatform=function(){if(this._platform)return this._platform;var e=this._getPlatformName();return this._platform=e||null,this._platform},r.prototype._getPlatformName=function(){if(e.hasOwnProperty("chrome")&&/Chrome/.test(e.navigator.userAgent)&&/Google Inc/.test(e.navigator.vendor))return"CHROME";if(/Firefox/.test(e.navigator.userAgent)&&"undefined"!==e.InstallTrigger)return"FIREFOX";if(/Safari/.test(e.navigator.userAgent)&&/Apple Computer/.test(e.navigator.vendor)){if(e.hasOwnProperty("safari"))return"SAFARI";console.warn('Probably the user is using a mobile safari browser! "safari" object is not present on "window"')}return!1},r.prototype._getBrowserVersion=function(){if(this._browserVersion)return this._browserVersion;var t="";switch(this._getPlatform()){case"CHROME":t=e.navigator.userAgent.match(/Chrom(e|ium|eframe)\/([0-9]+)\./i)[0];break;case"FIREFOX":t=e.navigator.userAgent.match(/Firefox\/([0-9]+)\./i)[0];break;case"SAFARI":t="Safari/"+e.navigator.userAgent.match(/Version\/(([0-9]+)(\.|[0-9])+)/i)[1]}return this._browserVersion=t||null,this._browserVersion},r.prototype._checkAllFeatures=function(){if(!this._checkFeature("postMessage"))return void console.warn('"postMessage" is not supported.');if(!this._checkFeature("Notification"))return void console.warn('"Notification" is not supported.');if(!this._checkFeature("localStorage"))return void console.warn('"localStorage" is not supported.');var e=this._getPlatform();if("CHROME"===e||"FIREFOX"===e){if(!this._checkFeature("permission"))return void console.warn("This browser dont support Notifications");if(!this._checkFeature("showNotification"))return void console.warn('"showNotification" is not supported.');if(!this._checkFeature("serviceWorker"))return void console.warn('"serviceWorker" is not supported.');if(!this._checkFeature("PushManager"))return void console.warn('"PushManager" is not supported.')}else if("SAFARI"===e&&!this._checkFeature("pushNotification"))return void console.warn('"pushNotification" is not supported.');return!0},o=function(t){this.baseUrl=t||e.location.href},o.prototype._createAbsoluteUrl=function(e){var t="",r=null;if(e)return e.match("^https?://")?t=e:"/"===e[0]?(r=/^((https?:\/\/(.+?))\/)/i.exec(this.baseUrl),r&&r[2]&&(t=r[2]+e)):(r=/^(https?:\/\/(.+)\/)/i.exec(this.baseUrl),r&&r[1]&&(t=r[1]+e)),t},o.prototype._makeBase64OfImage=function(t){var r=e.document.createElement("canvas"),o=r.getContext("2d");return r.width=t.width,r.height=t.height,o.drawImage(t,0,0),r.toDataURL("image/png")},o.prototype._loadImageBase64FromUrl=function(t){var r,o,a,n=this;return new Promise(function(i,s){r=new e.Image,r.addEventListener("load",function(e){clearInterval(o),i(n._makeBase64OfImage(this)),e.stopPropagation()},!0),r.addEventListener("error",function(e){clearInterval(o),s(e),e.stopPropagation()},!0),r.src=n._createAbsoluteUrl(t),o=setInterval(function(){a>150&&(clearInterval(o),s("_loadImageBase64FromUrl() Timeout!")),a+=1},50)})},o.prototype._loadStylesForTemplate=function(t){var r,o,a,n,i,s,p=this,u=[],c=t.getElementsByTagName("link"),d=0,l=null;return new Promise(function(m,f){for(r=0;r<c.length;r++)"stylesheet"===c[r].rel?(a=c[r].href,a?(a=p._createAbsoluteUrl(a),e.fetch(a).then(function(e){e.text().then(function(e){if(n=e.match(/url\s?\((["']?)(.+\.(png|jpg|gif|jpeg){1})\1?\)/gi))for(o=0;o<n.length;o++)i=/url\s?\((["']?)(.+\.(png|jpg|gif|jpeg){1})\1?\)/gi.exec(n[o]),i&&i[2]&&(s=p._createAbsoluteUrl(i[2]),s&&(e=e.replace(n[o],"url('"+s+"')")));u.push(e)},function(){u.push("")})},function(e){console.error("fetch error",e),u.push("")})):u.push("")):u.push("");l=setInterval(function(){if(u.length>=c.length){var r=e.document.createElement("style");for(r.innerHTML=u.join(" "),t.head.appendChild(r);c[0];)c[0].parentNode.removeChild(c[0]);clearInterval(l),m(t)}else d>150&&(console.error("cssTags",c),console.error("cssContent",u),clearInterval(l),f("_loadStylesForTemplate() Timeout!")),d+=1},50)})},o.prototype._loadImagesForTemplate=function(t){var r,o,a,n,i,s=this,p=[],u=t.getElementsByTagName("img"),c=0,d=null;return new Promise(function(l,m){for(n=0;n<u.length;n++){if(!u[n].src){if(r=/src="((.+?)\.(jpg|jpeg|gif|png))"/gi.exec(u[n].outerHTML),!r||!r[1])continue;o=s._createAbsoluteUrl(r[1]),o&&(u[n].src=o)}a=new e.Image,a.addEventListener("load",function(e){p[this.id]=s._makeBase64OfImage(this),e.stopPropagation()},!0),a.addEventListener("error",function(e){p[this.id].base64="false",e.stopPropagation()},!0),a.id=n,a.src=u[n].src}d=setInterval(function(){if(p.length>=u.length){for(i=0;i<u.length;i++)u[i].src=p[i];clearInterval(d),l(t)}else c>150&&(console.error("imagesContent",p),console.error("imagesTags",u),clearInterval(d),m("_loadImagesForTemplate() Timeout!")),c+=1},50)})},o.prototype._loadImagesFromStylesForTemplate=function(t){var r,o,a,n,i,s,p,u,c=this,d={},l=t.head.outerHTML+t.body.outerHTML,m=l.match(/url\s?\((["']?)(.+\.(png|jpg|gif|jpeg){1})\1?\)/gi),f=0,h=null,g=!0;return new Promise(function(_,v){if(m){for(r=0;r<m.length;r++)i=/url\s?\((["']?)(.+\.(png|jpg|gif|jpeg){1})\1?\)/gi.exec(m[r]),i&&i[2]&&(s=c._createAbsoluteUrl(i[2]),s&&(d[s]={$1:i[1],$2:i[2],base64:""}));for(o in d)d.hasOwnProperty(o)&&(p=new e.Image,p.addEventListener("load",function(e){d[this.id].base64=c._makeBase64OfImage(this),e.stopPropagation()},!0),p.addEventListener("error",function(e){d[this.id].base64="false",e.stopPropagation()},!0),p.id=o,p.src=o);h=setInterval(function(){for(a in d)d.hasOwnProperty(a)&&(d[a].base64||(g=!1));if(g){for(n in d)d.hasOwnProperty(n)&&"false"!==d[n].base64&&(u="",u=d[n].$1?d[n].base64:"'"+d[n].base64+"'",l=l.replace(n,u).replace(d[n].$2,u));clearInterval(h),_((new e.DOMParser).parseFromString("<!DOCTYPE html>"+l,"text/html"))}else f>150&&(console.error("cssImagesContent",d),clearInterval(h),v("_loadImagesFromStylesForTemplate() Timeout!")),f+=1},50)}else _(t)})},o.prototype._cleanAndPrepareHtml=function(t){var r=this;return new Promise(function(o,a){var n=(new e.DOMParser).parseFromString(t.replace(/<script.*?>((\n*)?.*?(\n*)?)*?<\/script>/gim,""),"text/html");r._loadStylesForTemplate(n).then(function(t){r._loadImagesForTemplate(t).then(function(t){r._loadImagesFromStylesForTemplate(t).then(function(t){var r=e.document.createElement("link");r.rel="manifest",r.href="/webpush-chrome-manifest.json",t.head.appendChild(r),o("<!DOCTYPE html><html>"+t.head.outerHTML+t.body.outerHTML+"</html>")},function(e){a(e)})},function(e){a(e)})},function(e){a(e)})})},a=function(){this.data={devid:null,appid:null,hwid:null,regid:null,alias:null,platform:null,setupEndPoint:null,templateEndPoint:null,safariPushID:null}},a.prototype._get=function(t,r){if(this.data[t])return this.data[t];r=r||"smartpush_params";try{var o=JSON.parse(e.localStorage.getItem(r));return o[t]||o[t]===!1?(this.data[t]=o[t],o[t]):null}catch(a){return null}},a.prototype._set=function(t,r){var o,a,n;if("object"==typeof t){r=r||"smartpush_params";try{n=JSON.parse(e.localStorage.getItem(r));for(o in n)n.hasOwnProperty(o)&&(this.data[o]=n[o])}catch(i){}for(a in t)t.hasOwnProperty(a)&&(this.data[a]=t[a]);e.localStorage.setItem(r,JSON.stringify(this.data))}},n=function(){this.version=i,this.iframe=e.document.createElement("iframe"),this.popup=null},n.prototype.events=new t,n.prototype.support=new r,n.prototype.template=new o,n.prototype.params=new a,n.prototype.control={iframe:{isLoading:!1,hasLoaded:!1},hasSetup:!1,eventForPostMassageIsListening:!1,register:{tries:0,waitInSeconds:10,maxTimeoutInMinutes:1}},n.prototype.registerEndPoint=s+"/device",n.prototype.optOutEndPoint=s+"/device/optout",n.prototype.tagEndPoint=s+"/tag",n.prototype.notificationEndPoint=s+"/notifications",n.prototype.safariEndPoint=s+"/safari",n.prototype._encodeParams=function(e){var t,r=[];if("object"==typeof e){for(t in e)e.hasOwnProperty(t)&&r.push(encodeURIComponent(t)+"="+encodeURIComponent(e[t]));return r.join("&")}return"string"==typeof e?e:(console.error('Parameters cannot be parsed. Use "object" or a url encoded "string". Unknown type...',typeof e),!1)},n.prototype._request=function(t,r,o){var a=this._encodeParams(r);return new Promise(function(r,n){return t&&a?(o?(a+="&_method="+o,o="POST"):o="POST",void e.fetch(t,{method:o,headers:{"Content-type":"application/x-www-form-urlencoded; charset=UTF-8"},body:a}).then(function(e){e.json().then(function(e){r(e)},function(e){n(e)})},function(e){n(e)})):(n("URL: "+t+" | PARAMS: "+a),!1)})},n.prototype._processMessageFromIframe=function(e){e.data.eventId||"subscribed"!==e.data.status||"object"!=typeof e.data.params?e.data.eventId&&this.events.once(e.data.eventId,e.data):(this.params._set(e.data.params),this.events.once("subscribed"))},n.prototype._postMessageToIframe=function(e,t){var r=this;return new Promise(function(o,a){if(!r.iframe)return a("Iframe dont exist or wasnt initialize yet.");e=e||"";var n=null,i={eventId:e+"-"+(new Date).getTime()+"-"+Math.random(),action:e};t&&"object"==typeof t&&(i.params=t),r.events.one(i.eventId,function(e){clearTimeout(n),e.detail&&e.detail.params&&"object"==typeof e.detail.params&&r.params._set(e.detail.params),o(e.detail)}),"doSubscribe"!==e&&(n=setTimeout(function(){a("postMessage event timeout: "+i.eventId)},5e3)),r.iframe.contentWindow.postMessage(i,"*")})},n.prototype._addIframe=function(t){var r=this;return this.control.iframe.hasLoaded?void t():void(this.control.iframe.isLoading||(this.iframe.id="smartpush-webpush-iframe",this.iframe.style.display="none",this.iframe.src=(this.params._get("setupEndPoint")||"")+"/lib"+(this.version?"-"+this.version:"")+".html",this.iframe.onload=function(){r.control.iframe.hasLoaded||(r.control.iframe.hasLoaded=!0,r.control.iframe.isLoading=!1,t())},this.iframe.onerror=function(e){console.error(e)},e.document.body.appendChild(this.iframe),this.control.iframe.isLoading=!0))},n.prototype._addIframeEvents=function(){var t=this;this.control.eventForPostMassageIsListening===!1&&(e.addEventListener?e.addEventListener("message",function(e){"smartpush.webpush.iframe"===e.data.source&&t._processMessageFromIframe(e)},!1):e.attachEvent("onmessage",function(e){"smartpush.webpush.iframe"===e.data.source&&t._processMessageFromIframe(e)}),this.control.eventForPostMassageIsListening=!0)},n.prototype._openPopUp=function(){var t=440,r=330,o=e.screen.width/2-t/2,a=e.screen.height/2-r/2,n="toolbar=no,location=no,status=no,menubar=no,scrollbars=no,resizable=no,width="+t+",height="+r+",left="+o+",top="+a,i=this.params._get("setupEndPoint")+"/lib"+(this.version?"-"+this.version:"")+".html";return!this.popup||this.popup.closed?this.popup=e.open(i,"notification",n):this.popup&&!this.popup.closed?this.popup.focus():this.popup=e.open(i,"notification",n),this.popup?(this.popup.focus(),!0):!1},n.prototype._setupUserTemplate=function(){var t,r=this,a={callback:e.location.href,subscribe:!0};e.fetch(r.params._get("templateEndPoint")).then(function(n){n.text().then(function(n){t=new o(r.params._get("templateEndPoint")),t._cleanAndPrepareHtml(n).then(function(t){t.length>5232400?console.error("Your template is too big!"):r._postMessageToIframe("ping",{template:t}).then(function(){e.location.href=r.iframe.src+"?"+r._encodeParams(a)},function(e){console.error("postMessage timeout!",e)})},function(e){console.error(e)})})},function(e){console.error("Template target error!",e)})},n.prototype._setupDefaultTemplate=function(t){var r,a,n=this,i={callback:e.location.href};r=n.params._get("templateImageUrl"),r&&-1===r.indexOf("https")?(a=new o,a._loadImageBase64FromUrl(r).then(function(r){n._postMessageToIframe("ping",{templateImageBase64:r}).then(function(){t?e.location.href=n.iframe.src+"?"+n._encodeParams(i):n._openPopUp()},function(e){console.error(e)})},function(e){console.error(e)})):t?e.location.href=n.iframe.src+"?"+n._encodeParams(i):n._openPopUp()},n.prototype._initialize=function(t){var r=this,o=this.support._getPlatform(),a=!1;return new Promise(function(n,i){if("CHROME"===o||"FIREFOX"===o){if("initSubscribe"===t&&(r.params._get("hwid")&&r.params._get("regid")||r.params._get("setupEndPoint")&&!r.params._get("templateEndPoint")&&(r._openPopUp()||(a=!0))),r.control.hasSetup===!0)return n();r._addIframeEvents(),r._addIframe(function(){r._postMessageToIframe(t,{devid:r.params._get("devid"),appid:r.params._get("appid"),platform:r.params._get("platform"),setupEndPoint:r.params._get("setupEndPoint"),templateEndPoint:r.params._get("templateEndPoint"),templateImageUrl:r.params._get("templateImageUrl"),templateSiteName:r.params._get("templateSiteName")}).then(function(t){switch(t.status){case"ready":r.control.hasSetup=!0,n(t);break;case"pong":n(t);break;case"setup-ssl-error":case"setup-error":if(!r.params._get("setupEndPoint")){i(t);break}case"setup-reload":if(-1!==e.location.href.indexOf("https"))return void console.warn("You are using a secure connection. HTTPS");case"registered-redirect":r.control.hasSetup=!0,r.checkStatus().then(function(e){if(r.params._get("templateEndPoint")){if("denied"===e)return void n(t);r._setupUserTemplate()}else r._setupDefaultTemplate(a)},function(e){console.error(e)})}},function(e){console.error("postMessage timeout!",e),i()})})}else if("SAFARI"===o){if(r.params._get("safariPushID")&&r.params._get("hwid")&&r.params._get("regid"))return n(),!0;r._request(r.safariEndPoint+"/getPushID",{devid:r.params._get("devid"),appid:r.params._get("appid")},"POST").then(function(e){200===e.code&&e.safariPushID?(r.params._set({safariPushID:e.safariPushID}),n()):i(e.message)},function(e){console.error("Cannot fetch safari app Push ID",e),i(e)})}})},n.prototype._loadExternalScript=function(e,t){var r=document.createElement("script");r.src=e,r.async=!0,t&&(r.onreadystatechange=r.onload=function(){var e=r.readyState;t.done||e&&!/loaded|complete/.test(e)||(t.done=!0,t())}),document.getElementsByTagName("head")[0].appendChild(r)},n.prototype.ready=function(){var t=this;return new Promise(function(r,o){return e.fetch?r():void t._loadExternalScript(p,function(){return e.fetch?r():void o()})})},n.prototype.checkStatus=function(){var t=this,r=this.support._getPlatform();return new Promise(function(o,a){t._initialize("checkStatus").then(function(){if("CHROME"===r||"FIREFOX"===r)t._postMessageToIframe("checkSubscriptionStatus").then(function(r){switch(r.status){case"status-true-checked":o("granted");break;case"status-sm-unreachable":t.params._get("setupEndPoint")||(e.document.body.removeChild(e.document.getElementById("smartpush-webpush-iframe")),t.control.hasSetup=!1,t.control.iframe.hasLoaded=!1);case"status-false-checked":o("default");break;case"status-denied-checked":o("denied")}},function(e){a(e)});else if("SAFARI"===r){var n=e.safari.pushNotification.permission(t.params._get("safariPushID"));"default"===n.permission?o("default"):"granted"===n.permission?t.params._get("hwid")&&t.params._get("regid")?o("granted"):t.params._get("setupEndPoint")?t._postMessageToIframe("getLocalStorageParams").then(function(){o("granted")},function(){console.error("postMessage timeout!"),o("default")}):o("default"):o("denied"===n.permission?"denied":"default")}},function(e){console.error("Cannot setup web push service to check user status",e),a(e)})})},n.prototype.subscribe=function(){var t=this,r=this.support._getPlatform();return new Promise(function(o,a){t._initialize("initSubscribe").then(function(){"CHROME"===r||"FIREFOX"===r?t.checkStatus().then(function(e){return"denied"==e?void a("denied"):t.params._get("hwid")&&t.params._get("regid")&&"granted"==e?void o(t):t.params._get("setupEndPoint")&&!t.params._get("templateEndPoint")&&t._openPopUp()?void t.events.one("subscribed",function(){o(t)}):void t._postMessageToIframe("doSubscribe").then(function(e){switch(e.status){case"subscribed":o(t);break;case"subscribed-error":a("error");break;case"default":a("default");break;case"denied":a("denied");break;default:console.error('No "data.status" match',e.status),a("error")}},function(e){console.error(e),a("error")})},function(e){console.error(e),a("error")}):"SAFARI"===r&&e.safari.pushNotification.requestPermission(t.safariEndPoint,t.params._get("safariPushID"),{devid:t.params._get("devid"),appid:t.params._get("appid")},function(n){"default"===n.permission?a("default"):"granted"===n.permission?t._request(t.registerEndPoint,{appid:t.params._get("appid"),uuid:"null",platform:r,regid:n.deviceToken,device:"Safari/"+e.navigator.userAgent.match(/Version\/(([0-9]+)(\.|[0-9])+)/i)[1],manufacturer:e.navigator.vendor,framework:e.navigator.platform||e.navigator.oscpu},"POST").then(function(e){200===e.code&&e.hwid?(t.params._set({hwid:e.hwid,regid:n.deviceToken,alias:e.alias}),t.params._get("setupEndPoint")&&t._postMessageToIframe("ping",{devid:t.params._get("devid"),appid:t.params._get("appid"),hwid:e.hwid,regid:n.deviceToken,alias:e.alias,platform:t.params._get("platform"),setupEndPoint:t.params._get("setupEndPoint"),templateEndPoint:t.params._get("templateEndPoint"),templateImageUrl:t.params._get("templateImageUrl"),templateSiteName:t.params._get("templateSiteName")}).then(function(e){"pong"===e.status?o(t):a("Its not you! Baby...")},function(){console.error("Cannot set parameters on centralized domain."),a("error")})):(console.error(e.message),a("error"))},function(e){console.error("Cannot register extra data for this device!",e),a("error")}):a("denied"===n.permission?"denied":"default")})},function(e){console.error("Cannot setup web push service for subscribe to webpush",e),a("error")})})},n.prototype.unSubscribe=function(){var e=this;return new Promise(function(t,r){e._postMessageToIframe("unsubscribe").then(function(o){switch(o.status){case"unsubscribed":e._request(e.registerEndPoint,{devid:e.params._get("devid"),appid:e.params._get("appid"),uuid:e.params._get("hwid")},"DELETE").then(function(){e.params._set({regid:null,alias:null}),e.params._get("templateEndPoint")&&(e.control.hasSetup=!1),t()},function(e){console.error("Cannot un-register this user on DB. It will be removed in next dry-run!",e),r()});break;case"unsubscribed-error":r()}},function(){r()})})},n.prototype.getLastNotifications=function(e){var t,r=this;return new Promise(function(o,a){return r._request(r.notificationEndPoint+"/last",{devid:r.params._get("devid"),appid:r.params._get("appid"),hwid:r.params._get("hwid"),regid:r.params._get("regid"),platform:r.support._getPlatform(),dateFormat:e||"",browserVersion:r.support._getBrowserVersion()},"POST").then(function(e){for(t=0;t<e.length;t++)e[t].payload.icon=e[t].payload.icon&&e[t].payload.icon+"".indexOf("http")!==-1?e[t].payload.icon:(r.params._get("setupEndPoint")?r.params._get("setupEndPoint"):"")+"/lib-default-icon.png";o(e)},function(e){console.error("Cannot fetch user Notifications",e),a(e)})})},n.prototype.getUnreadNotifications=function(e){var t,r=this;return new Promise(function(o,a){return r._request(r.notificationEndPoint+"/unread",{devid:r.params._get("devid"),appid:r.params._get("appid"),hwid:r.params._get("hwid"),regid:r.params._get("regid"),platform:r.support._getPlatform(),dateFormat:e||"",browserVersion:r.support._getBrowserVersion()},"POST").then(function(e){for(t=0;t<e.length;t++)e[t].payload.icon=e[t].payload.icon&&e[t].payload.icon+"".indexOf("http")!==-1?e[t].payload.icon:(r.params._get("setupEndPoint")?r.params._get("setupEndPoint"):"")+"/lib-default-icon.png";o(e)},function(e){console.error("Cannot fetch user Unred Notifications",e),a(e)})})},n.prototype.removeUnreadNotification=function(e){return this._request(this.notificationEndPoint+"/read-one",{devid:this.params._get("devid"),appid:this.params._get("appid"),hwid:this.params._get("hwid"),regid:this.params._get("regid"),pushid:e,browserVersion:this.support._getBrowserVersion()},"DELETE")},n.prototype.removeAllUnreadNotifications=function(){return this._request(this.notificationEndPoint+"/read-all",{devid:this.params._get("devid"),appid:this.params._get("appid"),hwid:this.params._get("hwid"),regid:this.params._get("regid"),browserVersion:this.support._getBrowserVersion()},"DELETE")},n.prototype.getTag=function(e){return this._request(this.tagEndPoint+"/"+this.params._get("hwid"),{devid:this.params._get("devid"),appid:this.params._get("appid"),regid:this.params._get("regid"),key:e,browserVersion:this.support._getBrowserVersion()},"POST")},n.prototype.addTag=function(e,t,r){return r||(r="STRING"),"LIST"===r&&(t=JSON.stringify(t)),this._request(this.tagEndPoint,{devid:this.params._get("devid"),appid:this.params._get("appid"),uuid:this.params._get("hwid"),regid:this.params._get("regid"),type:r,key:e,value:t,browserVersion:this.support._getBrowserVersion()},"POST")},n.prototype.removeTag=function(e,t,r){return r||(r="STRING"),"LIST"===r&&(t=JSON.stringify(t)),this._request(this.tagEndPoint,{devid:this.params._get("devid"),appid:this.params._get("appid"),uuid:this.params._get("hwid"),regid:this.params._get("regid"),type:r,key:e,value:t,browserVersion:this.support._getBrowserVersion()},"DELETE")},n.prototype.optOut=function(e){return this._request(this.optOutEndPoint,{devid:this.params._get("devid"),appid:this.params._get("appid"),uuid:this.params._get("hwid"),regid:this.params._get("regid"),block:e?"1":"0",browserVersion:this.support._getBrowserVersion()},"PUT")},n.prototype.getAlias=function(){return this.params._get("alias")},e.Smartpush={create:function(t){if(!t.devid||"DEVID"===t.devid)return void console.error('"devid" was NOT set correctly, see the documentation');if("object"!=typeof t.appid)return void console.error('"appid" must be an Object');if(t.ssl&&"object"!=typeof t.ssl)return void console.error('"ssl" must be an Object');if(t.template&&"object"!=typeof t.template)return void console.error('"template" must be an Object');var r=new n,o=r.support._getPlatform();if("CHROME"!==o&&"SAFARI"!==o&&"FIREFOX"!==o)return void console.info("Platform not Allowed for Webpush:",[e.navigator.vendor,e.navigator.userAgent]);if(!r.support._checkAllFeatures())return void console.error("This browser doesnt have all features to receive webpush.");var a=t.ssl;if(a&&a.url&&"string"==typeof a.url){if(-1===a.url.indexOf("https"))return void console.error("The URL informed ("+a.url+") is not secure. Please, use https");"/"===a.url.slice(-1)&&(a.url=a.url.substring(0,a.url.length-1))}else a=!1;if(r.params._set({setupEndPoint:a&&a.url?a.url:!1}),-1===window.location.href.indexOf("https")&&!r.params._get("setupEndPoint"))return void console.error('You are using a "http" connection, but the URL in the "ssl" object, in the setup() method, dont exist or is invalid. See the documentation');var i=a.template||!1;if(i)if("string"==typeof i){if(-1===i.indexOf("http"))return void console.error('To use the template render feature, you must inform a valid absolute url for the "template" property');if("SAFARI"!==o&&!r.params._get("setupEndPoint"))return void console.error('Without a valid ssl "url" you cant make use of the template render feature');"/"===i.slice(-1)&&(i=i.substring(0,i.length-1)),r.params._set({templateEndPoint:i,templateImageUrl:!1,templateSiteName:!1})}else if("object"==typeof i){if(i.imageUrl&&-1===i.imageUrl.indexOf("http"))return void console.error('To use a custom image, you must inform a valid absolute url for the "imageUrl" property');r.params._set({templateEndPoint:!1,templateImageUrl:i.imageUrl||!1,templateSiteName:i.siteName||!1})}else r.params._set({templateEndPoint:!1,templateImageUrl:!1,templateSiteName:!1});else r.params._set({templateEndPoint:!1,templateImageUrl:!1,templateSiteName:!1});var s;switch(o){case"CHROME":if(t.appid.chrome===!1)return void console.warn("Chrome Disabled");if(!t.appid.chrome||"APPID"===t.appid.chrome)return void console.error('No "appid" found for chrome. See the documentation');s=t.appid.chrome;break;case"SAFARI":if(t.appid.safari===!1)return void console.warn("Safari Disabled");if(!t.appid.safari||"APPID"===t.appid.chrome)return void console.error('No "appid" found for safari. See the documentation');s=t.appid.safari;break;case"FIREFOX":if(t.appid.firefox===!1)return void console.warn("Safari Disabled");if(!t.appid.firefox||"APPID"===t.appid.chrome)return void console.error('No "appid" found for firefox. See the documentation');s=t.appid.firefox}return r.params._set({devid:t.devid,appid:s,platform:o}),r}}}(window);